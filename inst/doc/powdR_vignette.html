<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Benjamin Butler" />

<meta name="date" content="2020-03-31" />

<title>powdR: Full Pattern Summation of X-ray Powder Diffraction Data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">powdR: Full Pattern Summation of X-ray Powder Diffraction Data</h1>
<h4 class="author">Benjamin Butler</h4>
<h4 class="date">2020-03-31</h4>



<style type="text/css">

body{ /* Normal  */
      font-size: 16px;
  }
code.r{ /* Code block */
    font-size: 16px;
}
p {line-height: 1.5em;}
</style>
<div id="overview" class="section level1">
<h1><span class="header-section-number">1</span> Overview</h1>
<p><code>powdR</code> is an R implementation of the full pattern summation approach to quantitative mineralogy from X-ray powder diffraction (XRPD) data. Whilst this is available in Excel spreadsheets such as FULLPAT <span class="citation">(Chipera and Bish 2002)</span> and RockJock <span class="citation">(Eberl 2003)</span>, implementation in R allows for faster computation than is currently available, and provides a user-friendly <code>Shiny</code> application to help with the often iterative process of mineral quantification. Furthermore, the <code>afps()</code> function in <code>powdR</code> is designed to automate the full pattern summation procedure, which is particularly advantageous in high-throughput XRPD datasets.</p>
</div>
<div id="full-pattern-summation" class="section level1">
<h1><span class="header-section-number">2</span> Full pattern summation</h1>
<p>A powerful property of XRPD data is that it can provide quantitative estimates of phase concentrations in mineral mixtures. Though several methods are available for such quantitative analysis, full pattern summation (also referred to as “full pattern fitting of prior measured standards”) is particularly suitable for mixtures containing crystalline mineral components in combination with disordered and/or X-ray amorphous phases. Soil is a prime example of such mixtures, where crystalline minerals such as quartz and feldspars can be present in combination with clay minerals (i.e. disordered phases), and organic matter (i.e. amorphous phases).</p>
<p>The full pattern summation implemented in <code>powdR</code> is based on the principle that an observed pattern is comprised of the sum of signals from the individual components within it. A key component of this approach is a library containing measured or calculated patterns of the pure phases that may be encountered within the samples. These “reference” patterns would ideally be measured on the same instrument as the sample. To quantify a given sample, suitable phases from the library are selected that together account for all peaks within the data, and their relative contributions to the observed signal optimised until an appropriate fit is achieved <span class="citation">(Chipera and Bish 2002)</span>. This fit is usually refined using least squares optimisation of an objective parameter. The scaled intensities of the optimised patterns are then converted to weight % using reference intensity ratios, which are a measure of diffracting power relative to a standard mineral (usually corundum).</p>
<hr />
</div>
<div id="using-powdr" class="section level1">
<h1><span class="header-section-number">3</span> Using <code>powdR</code></h1>
<div id="the-powdrlib-object" class="section level2">
<h2><span class="header-section-number">3.1</span> The <code>powdRlib</code> object</h2>
<p>A key component of the functions within <code>powdR</code> is the library of reference patterns. These are stored within a <code>powdRlib</code> object created using the <code>powdRlib()</code> constructor function. <code>powdRlib()</code> builds a <code>powdRlib</code> object from two components. The first component, specified via the <code>xrd_table</code> argument of <code>powdRlib()</code>, is a data frame of the count intensities of the reference patterns, with their 2<span class="math inline">\(\theta\)</span> axis as the first column. The column for a given reference pattern must be named using a unique identifier (a phase ID). An example of such a format is provided in the <code>minerals_xrd</code> data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(powdR)</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">data</span>(minerals_xrd)</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">head</span>(minerals_xrd[<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>])</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt;       tth ALB DOL.1 DOL.2 FEL GOE.1 GOE.2  ILL KAO</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; 1 4.00973 308   268   362 546  3549 10000 3078 525</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt; 2 4.04865 294   256   345 524  3511  9592 2960 500</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; 3 4.08757 286   250   343 505  3401  9323 2888 486</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt; 4 4.12649 277   247   327 512  3290  9042 2753 474</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt; 5 4.16541 275   241   318 478  3194  9248 2718 478</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt; 6 4.20433 261   228   314 459  3113  8557 2720 447</span></a></code></pre></div>
<p>The second component required to build a <code>powdRlib</code> object (specified via the <code>phases_table</code> argument of <code>powdRlib()</code>) is a data frame containing 3 columns. The first is a string of unique ID’s representing each reference pattern in the data provided to the <code>xrd_table</code> argument. The second column is the name of the phase group that this reference pattern belongs to (e.g. quartz or dolomite). The third column is the reference intensity ratio (RIR) of that reference pattern (relative to a known standard, usually corundum). An example of the format required for the <code>phases_table</code> argument of <code>powRlib()</code> is provided in the <code>minerals_phases</code> data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">data</span>(minerals_phases)</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3">minerals_phases[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>,]</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt;   phase_id  phase_name  rir</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; 1      ALB Plagioclase 1.31</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; 2    DOL.1    Dolomite 2.35</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; 3    DOL.2    Dolomite 2.39</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; 4      FEL  K-feldspar 0.75</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; 5    GOE.1    Goethite 0.93</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; 6    GOE.2    Goethite 0.37</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; 7      ILL      Illite 0.22</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; 8      KAO   Kaolinite 0.91</span></a></code></pre></div>
<p>Crucially when building the <code>powdRlib</code> object, all phase ID’s in the first column of the <code>phases_table</code> must match the column names of the <code>xrd_table</code> (except the name of the first column which is the 2<span class="math inline">\(\theta\)</span> scale), for example.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">identical</span>(<span class="kw">names</span>(minerals_xrd[<span class="op">-</span><span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb3-2" title="2">          minerals_phases<span class="op">$</span>phase_id)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Once created, <code>powdRlib</code> objects can easily be visualised using <code>plot()</code>, which when used for <code>powdRlib</code> objects accepts the arguments <code>wavelength</code> and <code>refs</code> that are used to specify the X-ray wavelength and the reference patterns to plot, respectively. <strong>In all cases where <code>plot()</code> is used hereafter, the addition of <code>interactive = TRUE</code> to the function call will produce an interactive html graph that can be viewed in RStudio or web browsers.</strong>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">my_lib &lt;-<span class="st"> </span><span class="kw">powdRlib</span>(minerals_xrd, minerals_phases)</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">plot</span>(my_lib, <span class="dt">wavelength =</span> <span class="st">&quot;Cu&quot;</span>,</a>
<a class="sourceLine" id="cb4-4" title="4">     <span class="dt">refs =</span> <span class="kw">c</span>(<span class="st">&quot;ALB&quot;</span>, <span class="st">&quot;DOL.1&quot;</span>,</a>
<a class="sourceLine" id="cb4-5" title="5">              <span class="st">&quot;QUA.1&quot;</span>, <span class="st">&quot;GOE.2&quot;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="subsetting-a-powdrlib-object" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Subsetting a <code>powdRlib</code> object</h3>
<p>Occasionally it may be useful to subset a reference library to a smaller selection. This can be achieved using <code>subset()</code>, which for <code>powdRlib</code> objects accepts three arguments; <code>x</code>, <code>refs</code> and <code>mode</code>. The <code>x</code> argument specifies the <code>powdRlib</code> object to be subset, <code>refs</code> specifies the ID’s and/or names of phases to select, and <code>mode</code> specifies whether these phases are kept (<code>mode = &quot;keep&quot;</code>) or removed (<code>mode = &quot;remove&quot;</code>).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">data</span>(rockjock)</a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#Have a look at the phase ID&#39;s in rockjock</span></a>
<a class="sourceLine" id="cb5-4" title="4">rockjock<span class="op">$</span>phases<span class="op">$</span>phase_id[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt;  [1] &quot;ACTINOLITE_TREMOLITE&quot; &quot;ALBITE_CLEAVELANDITE&quot; &quot;ALMANDINE_GARNET&quot;    </span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt;  [4] &quot;ALUNITE&quot;              &quot;AMPHIBOLE&quot;            &quot;ANALCIME&quot;            </span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt;  [7] &quot;ANATASE&quot;              &quot;ANDALUCITE&quot;           &quot;ANDESINE&quot;            </span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; [10] &quot;ANGLESITE&quot;</span></a>
<a class="sourceLine" id="cb5-9" title="9"></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#Remove reference patterns from rockjock</span></a>
<a class="sourceLine" id="cb5-11" title="11">rockjock_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">subset</span>(rockjock,</a>
<a class="sourceLine" id="cb5-12" title="12">                     <span class="dt">refs =</span> <span class="kw">c</span>(<span class="st">&quot;ALUNITE&quot;</span>, <span class="co">#phase ID</span></a>
<a class="sourceLine" id="cb5-13" title="13">                              <span class="st">&quot;AMPHIBOLE&quot;</span>, <span class="co">#phase ID</span></a>
<a class="sourceLine" id="cb5-14" title="14">                              <span class="st">&quot;ANALCIME&quot;</span>, <span class="co">#phase ID</span></a>
<a class="sourceLine" id="cb5-15" title="15">                              <span class="st">&quot;Plagioclase&quot;</span>), <span class="co">#phase name</span></a>
<a class="sourceLine" id="cb5-16" title="16">                     <span class="dt">mode =</span> <span class="st">&quot;remove&quot;</span>)</a>
<a class="sourceLine" id="cb5-17" title="17"></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#Check number of reference patterns remaining in library</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="kw">nrow</span>(rockjock_<span class="dv">1</span><span class="op">$</span>phases)</a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt; [1] 158</span></a>
<a class="sourceLine" id="cb5-21" title="21"></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#Keep certain reference patterns of rockjock</span></a>
<a class="sourceLine" id="cb5-23" title="23">rockjock_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">subset</span>(rockjock,</a>
<a class="sourceLine" id="cb5-24" title="24">                     <span class="dt">refs =</span> <span class="kw">c</span>(<span class="st">&quot;ALUNITE&quot;</span>, <span class="co">#phase ID</span></a>
<a class="sourceLine" id="cb5-25" title="25">                              <span class="st">&quot;AMPHIBOLE&quot;</span>, <span class="co">#phase ID</span></a>
<a class="sourceLine" id="cb5-26" title="26">                              <span class="st">&quot;ANALCIME&quot;</span>, <span class="co">#phase ID</span></a>
<a class="sourceLine" id="cb5-27" title="27">                              <span class="st">&quot;Plagioclase&quot;</span>), <span class="co">#phase name</span></a>
<a class="sourceLine" id="cb5-28" title="28">                     <span class="dt">mode =</span> <span class="st">&quot;keep&quot;</span>)</a>
<a class="sourceLine" id="cb5-29" title="29"></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="co">#Check number of reference patterns remaining</span></a>
<a class="sourceLine" id="cb5-31" title="31"><span class="kw">nrow</span>(rockjock_<span class="dv">2</span><span class="op">$</span>phases)</a>
<a class="sourceLine" id="cb5-32" title="32"><span class="co">#&gt; [1] 11</span></a></code></pre></div>
</div>
</div>
<div id="rockjock" class="section level2">
<h2><span class="header-section-number">3.2</span> RockJock</h2>
<p>There are two <code>powdRlib</code> objects provided as part of the <code>powdR</code> package. The first is <code>minerals</code> (accessed via <code>data(minerals)</code>), which is a simple and low resolution library designed to facilitate fast computation of basic examples. The second is <code>rockjock</code> (accessed via <code>data(rockjock)</code>), which is a comprehensive library of 169 reference patterns covering most phases that might be encountered in geological and soil samples. The <code>rockjock</code> library in <code>powdR</code> uses data from the original RockJock program <span class="citation">(Eberl 2003)</span> thanks to the permission of Dennis Eberl. In <code>rockjock</code>, each reference pattern from the original RockJock program has been scaled to a maximum intensity of 10000 counts, and the RIR’s normalised relative to Corundum. All <code>rockjock</code> data were analysed using Cu K<span class="math inline">\(\alpha\)</span> radiation.</p>
</div>
<div id="rockjock-synthetic-mixtures" class="section level2">
<h2><span class="header-section-number">3.3</span> RockJock synthetic mixtures</h2>
<p>To accompany the <code>rockjock</code> reference library, a list of eight synthetic mixtures from the original RockJock program <span class="citation">(Eberl 2003)</span> are also included in <code>powdR</code> in the <code>rockjock_mixtures</code> data (accessed via <code>data(rockjock_mixtures)</code>. Their known weights (see <code>?rockjock_mixtures</code>) can be compared to full pattern summation outputs (i.e. from <code>fps()</code> and <code>afps()</code>, detailed below) to assess accuracy.</p>
</div>
<div id="full-pattern-summation-1" class="section level2">
<h2><span class="header-section-number">3.4</span> Full pattern summation:</h2>
<p>Full pattern summation in <code>powdR</code> is provided via <code>fps()</code>, and an automated version provided in <code>afps()</code>. Here the <code>rockjock</code> and <code>rockjock_mixtures</code> data will be used to demonstrate the use of these functions.</p>
<div id="full-pattern-summation-with-internal-standard" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Full pattern summation <strong>with</strong> internal standard</h3>
<p>In some cases samples are prepared for XRPD with an internal standard of known concentration. If this is the case, then the <code>std_conc</code> argument of <code>fps()</code> and <code>afps()</code> can be used to define the concentration of the internal standard (in weight %), which is used in combination with the reference intensity ratios to compute phase concentrations. For example, all samples in the <code>rockjock_mixtures</code> data were prepared with 20 % corundum as the internal standard, thus this can be specified using using <code>std = &quot;CORUNDUM&quot;</code> and <code>std_conc = 20</code> in the call to <code>fps()</code> or <code>afps()</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">data</span>(<span class="st">&quot;rockjock_mixtures&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3">fit_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">fps</span>(<span class="dt">lib =</span> rockjock,</a>
<a class="sourceLine" id="cb6-4" title="4">             <span class="dt">smpl =</span> rockjock_mixtures<span class="op">$</span>Mix1,</a>
<a class="sourceLine" id="cb6-5" title="5">             <span class="dt">refs =</span> <span class="kw">c</span>(<span class="st">&quot;ORDERED_MICROCLINE&quot;</span>,</a>
<a class="sourceLine" id="cb6-6" title="6">                      <span class="st">&quot;LABRADORITE&quot;</span>,</a>
<a class="sourceLine" id="cb6-7" title="7">                      <span class="st">&quot;KAOLINITE_DRY_BRANCH&quot;</span>,</a>
<a class="sourceLine" id="cb6-8" title="8">                      <span class="st">&quot;MONTMORILLONITE_WYO&quot;</span>,</a>
<a class="sourceLine" id="cb6-9" title="9">                      <span class="st">&quot;ILLITE_1M_RM30&quot;</span>,</a>
<a class="sourceLine" id="cb6-10" title="10">                      <span class="st">&quot;CORUNDUM&quot;</span>),</a>
<a class="sourceLine" id="cb6-11" title="11">             <span class="dt">std =</span> <span class="st">&quot;CORUNDUM&quot;</span>,</a>
<a class="sourceLine" id="cb6-12" title="12">             <span class="dt">std_conc =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb6-13" title="13">             <span class="dt">align =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; -Aligning sample to the internal standard</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt; -Optimising...</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; -Computing phase concentrations</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; -Using internal standard concentration of 20 % to compute phase concentrations</span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt; ***Full pattern summation complete***</span></a></code></pre></div>
<p>The computed concentrations can be accessed in the <code>phases</code> dataframe of the <code>powdRlib</code> output:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">fit_<span class="dv">1</span><span class="op">$</span>phases</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt;               phase_id    phase_name   rir phase_percent</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt; 1             CORUNDUM      Corundum 1.000       20.0000</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; 2       ILLITE_1M_RM30        Illite 0.277        7.2480</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; 3 KAOLINITE_DRY_BRANCH     Kaolinite 0.581       12.6243</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; 4          LABRADORITE   Plagioclase 0.811       20.6976</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; 5  MONTMORILLONITE_WYO Smectite (Di) 0.320       42.2164</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; 6   ORDERED_MICROCLINE    K-feldspar 0.965        3.9287</span></a></code></pre></div>
<p>Further, notice that if the concentration of the internal standard is specified then the phase concentrations do not necessarily sum to 100 %:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">sum</span>(fit_<span class="dv">1</span><span class="op">$</span>phases<span class="op">$</span>phase_percent)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; [1] 106.715</span></a></code></pre></div>
<p>Unlike other software where only certain phases can be used as an internal standard, any phase can be defined in <code>powdR</code>. For example, the <code>rockjock_mixtures$Mix5</code> sample contains 20 % quartz (see <code>?rockjock_mixtures</code>), thus adding <code>&quot;QUARTZ&quot;</code> as the <code>std</code> argument results in this reference pattern becoming the internal standard instead.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">fit_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">fps</span>(<span class="dt">lib =</span> rockjock,</a>
<a class="sourceLine" id="cb9-2" title="2">             <span class="dt">smpl =</span> rockjock_mixtures<span class="op">$</span>Mix5,</a>
<a class="sourceLine" id="cb9-3" title="3">             <span class="dt">refs =</span> <span class="kw">c</span>(<span class="st">&quot;ORDERED_MICROCLINE&quot;</span>,</a>
<a class="sourceLine" id="cb9-4" title="4">                      <span class="st">&quot;LABRADORITE&quot;</span>,</a>
<a class="sourceLine" id="cb9-5" title="5">                      <span class="st">&quot;KAOLINITE_DRY_BRANCH&quot;</span>,</a>
<a class="sourceLine" id="cb9-6" title="6">                      <span class="st">&quot;MONTMORILLONITE_WYO&quot;</span>,</a>
<a class="sourceLine" id="cb9-7" title="7">                      <span class="st">&quot;CORUNDUM&quot;</span>,</a>
<a class="sourceLine" id="cb9-8" title="8">                      <span class="st">&quot;QUARTZ&quot;</span>),</a>
<a class="sourceLine" id="cb9-9" title="9">             <span class="dt">std =</span> <span class="st">&quot;QUARTZ&quot;</span>,</a>
<a class="sourceLine" id="cb9-10" title="10">             <span class="dt">std_conc =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb9-11" title="11">             <span class="dt">align =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; -Aligning sample to the internal standard</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">#&gt; -Optimising...</span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">#&gt; -Computing phase concentrations</span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#&gt; -Using internal standard concentration of 20 % to compute phase concentrations</span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">#&gt; ***Full pattern summation complete***</span></a>
<a class="sourceLine" id="cb9-19" title="19"></a>
<a class="sourceLine" id="cb9-20" title="20">fit_<span class="dv">2</span><span class="op">$</span>phases</a>
<a class="sourceLine" id="cb9-21" title="21"><span class="co">#&gt;               phase_id    phase_name   rir phase_percent</span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">#&gt; 1             CORUNDUM      Corundum 1.000       19.0339</span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">#&gt; 2 KAOLINITE_DRY_BRANCH     Kaolinite 0.581        4.3277</span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co">#&gt; 3          LABRADORITE   Plagioclase 0.811        7.8158</span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co">#&gt; 4  MONTMORILLONITE_WYO Smectite (Di) 0.320       10.6985</span></a>
<a class="sourceLine" id="cb9-26" title="26"><span class="co">#&gt; 5   ORDERED_MICROCLINE    K-feldspar 0.965       32.9610</span></a>
<a class="sourceLine" id="cb9-27" title="27"><span class="co">#&gt; 6               QUARTZ        Quartz 3.540       20.0000</span></a>
<a class="sourceLine" id="cb9-28" title="28"></a>
<a class="sourceLine" id="cb9-29" title="29"><span class="kw">sum</span>(fit_<span class="dv">2</span><span class="op">$</span>phases<span class="op">$</span>phase_percent)</a>
<a class="sourceLine" id="cb9-30" title="30"><span class="co">#&gt; [1] 94.8369</span></a></code></pre></div>
</div>
<div id="full-pattern-summation-without-internal-standard" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Full pattern summation <strong>without</strong> internal standard</h3>
<p>In cases where an internal standard is not added to a sample, phase quantification can be achieved by assuming that all detectable phases can be identified and that they sum to 100 weight %. By setting the <code>std_conc</code> argument of <code>fps()</code> or <code>afps()</code> to <code>NA</code>, or leaving it out of the function call, it will be assumed that the sample has been prepared without an internal standard and the phase concentrations computed accordingly.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">fit_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">fps</span>(<span class="dt">lib =</span> rockjock,</a>
<a class="sourceLine" id="cb10-2" title="2">             <span class="dt">smpl =</span> rockjock_mixtures<span class="op">$</span>Mix1,</a>
<a class="sourceLine" id="cb10-3" title="3">             <span class="dt">refs =</span> <span class="kw">c</span>(<span class="st">&quot;ORDERED_MICROCLINE&quot;</span>,</a>
<a class="sourceLine" id="cb10-4" title="4">                      <span class="st">&quot;LABRADORITE&quot;</span>,</a>
<a class="sourceLine" id="cb10-5" title="5">                      <span class="st">&quot;KAOLINITE_DRY_BRANCH&quot;</span>,</a>
<a class="sourceLine" id="cb10-6" title="6">                      <span class="st">&quot;MONTMORILLONITE_WYO&quot;</span>,</a>
<a class="sourceLine" id="cb10-7" title="7">                      <span class="st">&quot;ILLITE_1M_RM30&quot;</span>,</a>
<a class="sourceLine" id="cb10-8" title="8">                      <span class="st">&quot;CORUNDUM&quot;</span>),</a>
<a class="sourceLine" id="cb10-9" title="9">             <span class="dt">std_conc =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb10-10" title="10">             <span class="dt">std =</span> <span class="st">&quot;CORUNDUM&quot;</span>,</a>
<a class="sourceLine" id="cb10-11" title="11">             <span class="dt">align =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt; -Aligning sample to the internal standard</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">#&gt; -Optimising...</span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">#&gt; -Computing phase concentrations</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">#&gt; -Internal standard concentration unknown. Assuming phases sum to 100 %</span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="co">#&gt; ***Full pattern summation complete***</span></a></code></pre></div>
<p>In this case the phase specified in the <code>std</code> argument is only used for sample alignment, and is included in the computed phase concentrations.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">fit_<span class="dv">3</span><span class="op">$</span>phases</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">#&gt;               phase_id    phase_name   rir phase_percent</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">#&gt; 1             CORUNDUM      Corundum 1.000       18.7415</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt; 2       ILLITE_1M_RM30        Illite 0.277        6.7919</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt; 3 KAOLINITE_DRY_BRANCH     Kaolinite 0.581       11.8299</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt; 4          LABRADORITE   Plagioclase 0.811       19.3952</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt; 5  MONTMORILLONITE_WYO Smectite (Di) 0.320       39.5600</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#&gt; 6   ORDERED_MICROCLINE    K-feldspar 0.965        3.6814</span></a></code></pre></div>
<p>Furthermore, the phase concentrations sum to 100 %.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">sum</span>(fit_<span class="dv">3</span><span class="op">$</span>phases<span class="op">$</span>phase_percent)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt; [1] 99.9999</span></a></code></pre></div>
</div>
<div id="full-pattern-summation-with-data-harmonisation" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Full pattern summation with data harmonisation</h3>
<p>It is usually recommended that the reference library used for full pattern summation is measured on the same instrument as the sample using an identical 2<span class="math inline">\(\theta\)</span> range and resolution. In some cases this is not feasible, and the reference library patterns may be from a different instrument to the sample. To allow for seamless use of samples and libraries from different instruments (measured on the same wavelength), <code>fps()</code> and <code>afps()</code> contain a logical <code>harmonise</code> argument (default <code>= TRUE</code>). When the sample and library contain non-identical 2<span class="math inline">\(\theta\)</span> axes, <code>harmonise = TRUE</code> will convert the data onto the same scale by determining the overlapping 2<span class="math inline">\(\theta\)</span> range and interpolating to the coarsest resolution available.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co">#Create a sample with a shorter 2theta axis than the library</span></a>
<a class="sourceLine" id="cb13-2" title="2">Mix1_short &lt;-<span class="st"> </span><span class="kw">subset</span>(rockjock_mixtures<span class="op">$</span>Mix1, tth <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>tth <span class="op">&lt;</span><span class="st"> </span><span class="dv">55</span>)</a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#Reduce the resolution by selecting only odd rows of the data</span></a>
<a class="sourceLine" id="cb13-5" title="5">Mix1_short &lt;-<span class="st"> </span>Mix1_short[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(Mix1_short), <span class="dv">2</span>),]</a>
<a class="sourceLine" id="cb13-6" title="6"></a>
<a class="sourceLine" id="cb13-7" title="7">fit_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">fps</span>(<span class="dt">lib =</span> rockjock,</a>
<a class="sourceLine" id="cb13-8" title="8">             <span class="dt">smpl =</span> Mix1_short,</a>
<a class="sourceLine" id="cb13-9" title="9">             <span class="dt">refs =</span> <span class="kw">c</span>(<span class="st">&quot;ORDERED_MICROCLINE&quot;</span>,</a>
<a class="sourceLine" id="cb13-10" title="10">                      <span class="st">&quot;LABRADORITE&quot;</span>,</a>
<a class="sourceLine" id="cb13-11" title="11">                      <span class="st">&quot;KAOLINITE_DRY_BRANCH&quot;</span>,</a>
<a class="sourceLine" id="cb13-12" title="12">                      <span class="st">&quot;MONTMORILLONITE_WYO&quot;</span>,</a>
<a class="sourceLine" id="cb13-13" title="13">                      <span class="st">&quot;ILLITE_1M_RM30&quot;</span>,</a>
<a class="sourceLine" id="cb13-14" title="14">                      <span class="st">&quot;CORUNDUM&quot;</span>),</a>
<a class="sourceLine" id="cb13-15" title="15">             <span class="dt">std =</span> <span class="st">&quot;CORUNDUM&quot;</span>,</a>
<a class="sourceLine" id="cb13-16" title="16">             <span class="dt">align =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb13-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-18" title="18"><span class="co">#&gt; -Harmonising library to the same 2theta resolution as the sample</span></a>
<a class="sourceLine" id="cb13-19" title="19"><span class="co">#&gt; -Aligning sample to the internal standard</span></a>
<a class="sourceLine" id="cb13-20" title="20"><span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span></a>
<a class="sourceLine" id="cb13-21" title="21"><span class="co">#&gt; -Optimising...</span></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="co">#&gt; -Computing phase concentrations</span></a>
<a class="sourceLine" id="cb13-23" title="23"><span class="co">#&gt; -Internal standard concentration unknown. Assuming phases sum to 100 %</span></a>
<a class="sourceLine" id="cb13-24" title="24"><span class="co">#&gt; ***Full pattern summation complete***</span></a>
<a class="sourceLine" id="cb13-25" title="25"></a>
<a class="sourceLine" id="cb13-26" title="26">fit_<span class="dv">4</span><span class="op">$</span>phases</a>
<a class="sourceLine" id="cb13-27" title="27"><span class="co">#&gt;               phase_id    phase_name   rir phase_percent</span></a>
<a class="sourceLine" id="cb13-28" title="28"><span class="co">#&gt; 1             CORUNDUM      Corundum 1.000       18.6982</span></a>
<a class="sourceLine" id="cb13-29" title="29"><span class="co">#&gt; 2       ILLITE_1M_RM30        Illite 0.277        8.6246</span></a>
<a class="sourceLine" id="cb13-30" title="30"><span class="co">#&gt; 3 KAOLINITE_DRY_BRANCH     Kaolinite 0.581       13.0701</span></a>
<a class="sourceLine" id="cb13-31" title="31"><span class="co">#&gt; 4          LABRADORITE   Plagioclase 0.811       20.2498</span></a>
<a class="sourceLine" id="cb13-32" title="32"><span class="co">#&gt; 5  MONTMORILLONITE_WYO Smectite (Di) 0.320       35.4054</span></a>
<a class="sourceLine" id="cb13-33" title="33"><span class="co">#&gt; 6   ORDERED_MICROCLINE    K-feldspar 0.965        3.9519</span></a></code></pre></div>
</div>
</div>
<div id="automated-full-pattern-summation" class="section level2">
<h2><span class="header-section-number">3.5</span> Automated full pattern summation</h2>
<p>The selection of suitable reference patterns for full pattern summation can often be challenging and time consuming. An attempt to automate this process is provided in <code>afps()</code>, which can select appropriate reference patterns from a reference library and subsequently exclude reference patterns based on limit of detection estimates. Such an approach is considered particularly advantageous when quantifying high-throughput XRPD datasets that display considerable mineralogical variation.</p>
<p>Here the <code>rockjock</code> library, containing 169 reference patterns, will be used to quantify one of the samples in the <code>rockjock_mixtures</code> data.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">fit_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">afps</span>(<span class="dt">lib =</span> rockjock,</a>
<a class="sourceLine" id="cb14-2" title="2">              <span class="dt">smpl =</span> rockjock_mixtures<span class="op">$</span>Mix1,</a>
<a class="sourceLine" id="cb14-3" title="3">              <span class="dt">std =</span> <span class="st">&quot;CORUNDUM&quot;</span>,</a>
<a class="sourceLine" id="cb14-4" title="4">              <span class="dt">align =</span> <span class="fl">0.3</span>,</a>
<a class="sourceLine" id="cb14-5" title="5">              <span class="dt">lod =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="co">#&gt; -Using all reference patterns in the library</span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co">#&gt; -Aligning sample to the internal standard</span></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co">#&gt; -Applying non-negative least squares</span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="co">#&gt; -Optimising...</span></a>
<a class="sourceLine" id="cb14-12" title="12"><span class="co">#&gt; -Removing negative coefficients and reoptimising...</span></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="co">#&gt; -Calculating detection limits</span></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="co">#&gt; -Removing phases below detection limit</span></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="co">#&gt; -Reoptimising after removing crystalline phases below the limit of detection</span></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="co">#&gt; -Computing phase concentrations</span></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="co">#&gt; -Internal standard concentration unknown. Assuming phases sum to 100 %</span></a>
<a class="sourceLine" id="cb14-18" title="18"><span class="co">#&gt; ***Automated full pattern summation complete***</span></a>
<a class="sourceLine" id="cb14-19" title="19"></a>
<a class="sourceLine" id="cb14-20" title="20">fit_<span class="dv">5</span><span class="op">$</span>phases_grouped</a>
<a class="sourceLine" id="cb14-21" title="21"><span class="co">#&gt;      phase_name phase_percent</span></a>
<a class="sourceLine" id="cb14-22" title="22"><span class="co">#&gt; 1    Background        0.0001</span></a>
<a class="sourceLine" id="cb14-23" title="23"><span class="co">#&gt; 2      Corundum       18.2400</span></a>
<a class="sourceLine" id="cb14-24" title="24"><span class="co">#&gt; 3        Illite        7.5488</span></a>
<a class="sourceLine" id="cb14-25" title="25"><span class="co">#&gt; 4    K-feldspar        2.8130</span></a>
<a class="sourceLine" id="cb14-26" title="26"><span class="co">#&gt; 5     Kaolinite       11.4067</span></a>
<a class="sourceLine" id="cb14-27" title="27"><span class="co">#&gt; 6   Plagioclase       19.3968</span></a>
<a class="sourceLine" id="cb14-28" title="28"><span class="co">#&gt; 7     Sepiolite        2.9857</span></a>
<a class="sourceLine" id="cb14-29" title="29"><span class="co">#&gt; 8 Smectite (Di)       37.6090</span></a></code></pre></div>
</div>
<div id="plotting" class="section level2">
<h2><span class="header-section-number">3.6</span> Plotting</h2>
<p>Plotting results from <code>fps()</code> or <code>afps()</code> (<code>powdRfps</code> and <code>powdRafps</code> objects, respectively) is achieved using <code>plot()</code>. Static <code>ggplot()</code> plots can be created using:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">plot</span>(fit_<span class="dv">5</span>, <span class="dt">wavelength =</span> <span class="st">&quot;Cu&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Alternatively, interactive <code>ggplotly()</code> plots can be created by adding <code>interactive = TRUE</code> to the function call, e.g. <code>plot(fit_5, wavelength = &quot;Cu&quot;, interactive = TRUE)</code>.</p>
</div>
<div id="quantifying-multiple-samples" class="section level2">
<h2><span class="header-section-number">3.7</span> Quantifying multiple samples</h2>
<p>The easiest way to quantify multiple samples is with <code>lapply()</code></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">multi_fit &lt;-<span class="st"> </span><span class="kw">lapply</span>(rockjock_mixtures[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], fps,</a>
<a class="sourceLine" id="cb16-2" title="2">                    <span class="dt">lib =</span> rockjock,</a>
<a class="sourceLine" id="cb16-3" title="3">                    <span class="dt">std =</span> <span class="st">&quot;CORUNDUM&quot;</span>,</a>
<a class="sourceLine" id="cb16-4" title="4">                    <span class="dt">refs =</span> <span class="kw">c</span>(<span class="st">&quot;ORDERED_MICROCLINE&quot;</span>,</a>
<a class="sourceLine" id="cb16-5" title="5">                             <span class="st">&quot;LABRADORITE&quot;</span>,</a>
<a class="sourceLine" id="cb16-6" title="6">                             <span class="st">&quot;KAOLINITE_DRY_BRANCH&quot;</span>,</a>
<a class="sourceLine" id="cb16-7" title="7">                             <span class="st">&quot;MONTMORILLONITE_WYO&quot;</span>,</a>
<a class="sourceLine" id="cb16-8" title="8">                             <span class="st">&quot;ILLITE_1M_RM30&quot;</span>,</a>
<a class="sourceLine" id="cb16-9" title="9">                             <span class="st">&quot;CORUNDUM&quot;</span>,</a>
<a class="sourceLine" id="cb16-10" title="10">                             <span class="st">&quot;QUARTZ&quot;</span>),</a>
<a class="sourceLine" id="cb16-11" title="11">                    <span class="dt">align =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co">#&gt; -Aligning sample to the internal standard</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span></a>
<a class="sourceLine" id="cb16-15" title="15"><span class="co">#&gt; -Optimising...</span></a>
<a class="sourceLine" id="cb16-16" title="16"><span class="co">#&gt; -Computing phase concentrations</span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="co">#&gt; -Internal standard concentration unknown. Assuming phases sum to 100 %</span></a>
<a class="sourceLine" id="cb16-18" title="18"><span class="co">#&gt; ***Full pattern summation complete***</span></a>
<a class="sourceLine" id="cb16-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb16-20" title="20"><span class="co">#&gt; -Aligning sample to the internal standard</span></a>
<a class="sourceLine" id="cb16-21" title="21"><span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span></a>
<a class="sourceLine" id="cb16-22" title="22"><span class="co">#&gt; -Optimising...</span></a>
<a class="sourceLine" id="cb16-23" title="23"><span class="co">#&gt; -Computing phase concentrations</span></a>
<a class="sourceLine" id="cb16-24" title="24"><span class="co">#&gt; -Internal standard concentration unknown. Assuming phases sum to 100 %</span></a>
<a class="sourceLine" id="cb16-25" title="25"><span class="co">#&gt; ***Full pattern summation complete***</span></a>
<a class="sourceLine" id="cb16-26" title="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb16-27" title="27"><span class="co">#&gt; -Aligning sample to the internal standard</span></a>
<a class="sourceLine" id="cb16-28" title="28"><span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span></a>
<a class="sourceLine" id="cb16-29" title="29"><span class="co">#&gt; -Optimising...</span></a>
<a class="sourceLine" id="cb16-30" title="30"><span class="co">#&gt; -Removing negative coefficients and reoptimising...</span></a>
<a class="sourceLine" id="cb16-31" title="31"><span class="co">#&gt; -Computing phase concentrations</span></a>
<a class="sourceLine" id="cb16-32" title="32"><span class="co">#&gt; -Internal standard concentration unknown. Assuming phases sum to 100 %</span></a>
<a class="sourceLine" id="cb16-33" title="33"><span class="co">#&gt; ***Full pattern summation complete***</span></a>
<a class="sourceLine" id="cb16-34" title="34"></a>
<a class="sourceLine" id="cb16-35" title="35"><span class="kw">names</span>(multi_fit)</a>
<a class="sourceLine" id="cb16-36" title="36"><span class="co">#&gt; [1] &quot;Mix1&quot; &quot;Mix2&quot; &quot;Mix3&quot;</span></a></code></pre></div>
</div>
<div id="summarising-mineralogy" class="section level2">
<h2><span class="header-section-number">3.8</span> Summarising mineralogy</h2>
<p>When multiple samples are quantified, it is often useful to report the phase concentrations of all of the samples in a single table. For a given list of <code>powdRfps</code> and/or <code>powdRafps</code> objects, the <code>summarise_mineralogy()</code> function yields such summary tables, for example:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">summarise_mineralogy</span>(multi_fit, <span class="dt">type =</span> <span class="st">&quot;grouped&quot;</span>, <span class="dt">order =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co">#&gt;   sample_id Kaolinite Corundum Plagioclase Smectite (Di)  Illite K-feldspar</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">#&gt; 1      Mix1   11.7979  18.7715     19.3686       39.6349  6.5915     3.6197</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">#&gt; 2      Mix2   20.2828  19.2992     34.8406        2.9000  9.9577     8.0734</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">#&gt; 3      Mix3   38.5358  19.3107          NA        3.7139 19.5099    11.0668</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#&gt;   Quartz</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">#&gt; 1 0.2159</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">#&gt; 2 4.6464</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co">#&gt; 3 7.8629</span></a></code></pre></div>
<p>where <code>type = &quot;grouped&quot;</code> denotes that phases with the same <code>phase_name</code> will be summed together, and <code>order = TRUE</code> specifies that the columns will be ordered from most common to least common (assessed by the sum of each phase across the samples).</p>
</div>
<div id="the-powdr-shiny-app" class="section level2">
<h2><span class="header-section-number">3.9</span> The powdR Shiny app</h2>
<p>To run <code>powdR</code> via the Shiny app, use <code>run_powdR()</code>. This loads the application in your default web browser. The application has six tabs:</p>
<ol style="list-style-type: decimal">
<li><strong>Reference Library Builder:</strong> Allows you to create and export a <code>powdRlib</code> reference library from two .csv files: one for the XRPD measurements, and the other for the ID, name and reference intensity ratio of each pattern.</li>
<li><strong>Reference Library Viewer:</strong> Facilitates quick inspection of the phases within a <code>powdRlib</code> reference library.</li>
<li><strong>Reference Library Editor:</strong> Allows the user to easily subset a <code>powdRlib</code> reference library .</li>
<li><strong>Full Pattern Summation:</strong> A user friendly interface for iterative full pattern summation of single samples using <code>fps()</code> or <code>afps()</code>.</li>
<li><strong>Results Viewer/Editor:</strong> Allows for results from previously saved <code>powdRfps</code> and <code>powdRafps</code> objects to be viwed and edited via addition or removal of reference patterns.</li>
<li><strong>Help</strong> Provides a series of video tutorials (via YouTube) detailing the use of the <code>powdR</code> Shiny application.</li>
</ol>
<p><strong>Note: that the Shiny application may not work properly in Microsoft Edge web browsers. Please get in touch if you experience any other issues with the Shiny application.</strong></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Chipera2002">
<p>Chipera, Steve J., and David L. Bish. 2002. “FULLPAT: A full-pattern quantitative analysis program for X-ray powder diffraction using measured and calculated patterns.” <em>Journal of Applied Crystallography</em> 35 (6): 744–49. <a href="https://doi.org/10.1107/S0021889802017405">https://doi.org/10.1107/S0021889802017405</a>.</p>
</div>
<div id="ref-Eberl2003">
<p>Eberl, D. D. 2003. “User’s guide to ROCKJOCK - A program for determining quantitative mineralogy from powder X-ray diffraction data.” Boulder, CA: USGS.</p>
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
