<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Benjamin Butler" />

<meta name="date" content="2018-11-15" />

<title>powdR: Full Pattern Summation of X-ray Powder Diffraction Data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">powdR: Full Pattern Summation of X-ray Powder Diffraction Data</h1>
<h4 class="author"><em>Benjamin Butler</em></h4>
<h4 class="date"><em>2018-11-15</em></h4>



<p><code>powdR</code> is an R implementation of the full pattern summation approach to quantitative mineralogy from X-ray powder diffraction (XRPD) data. Whilst this is available in Excel spreadsheets such as FULLPAT <span class="citation">(Chipera and Bish 2002)</span> and ROCKJOCK <span class="citation">(Eberl 2003)</span>, implementation in R allows for faster computation than is currently available, and provides a user-friendly <code>shiny</code> application to help with the often iterative process of mineral quantification.</p>
<div id="full-pattern-summation" class="section level2">
<h2>Full pattern summation</h2>
<p>A powerful property of XRPD data is that it can provide quantitative estimates of phase concentrations (mineral and amorphous). Though several methods are available for quantitative mineralogy, full pattern summation is particularly suitable for mineral mixtures containing disordered and amorphous phases. A prime example of such mixtures is soil, where clay minerals represent disordered phases, and organic matter is present as a common X-ray amorphous constituent.</p>
<p>The full pattern summation implemented in <code>powdR</code> is based on the principle that an observed pattern is comprised of the sum of signals from pure individual components. A key component of this approach is a library of measured or calculated patterns of pure phases. The pure patterns should be sufficient to cover all of the phases that may be encountered in your samples, and would ideally be measured on the same instrument as the sample (but this is not always possible). To quantify a given sample, phases from the library are selected, and their relative contributions optimised until an appropriate fit of the observed pattern is achieved <span class="citation">(Chipera and Bish 2002)</span>. The fit is usually refined using least squares optimisation of an objective parameter, but non-negative least squares can also be used. The scaled intensities of the optimised patterns are then converted to weight % using reference intensity ratios, which are a measure of diffracting power relative to a standard mineral (usually corundum).</p>
<p>Version 0.2.0 of <code>powdR</code> currently implements full pattern summation via a standardless approach. The prerequisite of this approach is that all mineral and amorphous phases can be identified within the sample, and that these must sum to 100 weight % <span class="citation">(Chipera and Bish 2013; Omotoso et al. 2006)</span>.</p>
</div>
<div id="fps" class="section level2">
<h2><code>fps()</code></h2>
<p>Full pattern summation in <code>powdR</code> is provided in the <code>fps()</code> function. In the following example the full pattern summation process using <code>fps()</code> will start with a reference library containing a single quartz phase, and subsequent phases will be added by examining the residuals of the fit. If running this vignette yourself, all plots can be made interactive by:</p>
<p><code>plot(fit, interactive = TRUE)</code></p>
<p>Making them interactive aids visual interpretation of the fitted patterns, which can otherwise be difficult when using static plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(powdR)

<span class="kw">data</span>(minerals)
<span class="kw">data</span>(soils)

<span class="co">#Apply summation to the sandstone sample, with quartz as the only mineral</span>
fit &lt;-<span class="st"> </span><span class="kw">fps</span>(<span class="dt">lib =</span> minerals,
           <span class="dt">smpl =</span> soils<span class="op">$</span>sandstone,
           <span class="dt">refs =</span> <span class="st">&quot;QUA.1&quot;</span>,
           <span class="dt">std =</span> <span class="st">&quot;QUA.1&quot;</span>,
           <span class="dt">align =</span> <span class="fl">0.2</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; -Using maximum tth range</span>
<span class="co">#&gt; -Using default solver of BFGS</span>
<span class="co">#&gt; -Using default objective function of Rwp</span>
<span class="co">#&gt; -Aligning sample to the internal standard</span>
<span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span>
<span class="co">#&gt; -Optimising...</span>
<span class="co">#&gt; -Computing phase concentrations</span>
<span class="co">#&gt; -Full pattern summation complete</span>

<span class="co">#plot the data to interpret the fit</span>
<span class="kw">plot</span>(fit)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Figure 1: The resulting fit on a sandstone soil when fps() is applied using a single quartz reference pattern. The top plot displays the measured and fitted patterns, and the bottom plots displays the residuals." />
<p class="caption"><strong>Figure 1:</strong> The resulting fit on a sandstone soil when <code>fps()</code> is applied using a single quartz reference pattern. The top plot displays the measured and fitted patterns, and the bottom plots displays the residuals.</p>
</div>
<p>In this case, the fitted pattern consistently overestimates the quartz peak intensities compared to the measured pattern, but underestimates the background contribution. This can occur when X-ray amorphous phases are present within the sample. To Account for this, an organic matter phase from the reference library will be added, and the fit recomputed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Apply fps to the sandstone sample with quartz (crystalline) and organic matter (amorphous)</span>
fit &lt;-<span class="st"> </span><span class="kw">fps</span>(<span class="dt">lib =</span> minerals,
           <span class="dt">smpl =</span> soils<span class="op">$</span>sandstone,
           <span class="dt">refs =</span> <span class="kw">c</span>(<span class="st">&quot;QUA.1&quot;</span>, <span class="st">&quot;ORG&quot;</span>),
           <span class="dt">std =</span> <span class="st">&quot;QUA.1&quot;</span>,
           <span class="dt">align =</span> <span class="fl">0.2</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; -Using maximum tth range</span>
<span class="co">#&gt; -Using default solver of BFGS</span>
<span class="co">#&gt; -Using default objective function of Rwp</span>
<span class="co">#&gt; -Aligning sample to the internal standard</span>
<span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span>
<span class="co">#&gt; -Optimising...</span>
<span class="co">#&gt; -Computing phase concentrations</span>
<span class="co">#&gt; -Full pattern summation complete</span>

<span class="co">#plot the data to interpret the fit</span>
<span class="kw">plot</span>(fit)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Figure 2: The resulting full pattern fit on a sandstone soil when fps() is applied using reference patterns from quartz and organic matter." />
<p class="caption"><strong>Figure 2:</strong> The resulting full pattern fit on a sandstone soil when <code>fps()</code> is applied using reference patterns from quartz and organic matter.</p>
</div>
<p>Now the fit is much improved, highlighting how organic matter is an important component of this pattern. Based on the current residuals, there is a notable peak at 12.3 degrees 2theta, which is often associated with kaolinite. There are also numerous peaks either side of the main quartz peak at 26.6 degrees 2theta, which are often coincident with feldspar minerals. The next fit will therefore add kaolinite, plagioclase and potassium feldspar to the process.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Apply fps to the sandstone sample, adding kaolinite, feldspar and oligoclase to the process</span>
fit &lt;-<span class="st"> </span><span class="kw">fps</span>(<span class="dt">lib =</span> minerals,
           <span class="dt">smpl =</span> soils<span class="op">$</span>sandstone,
           <span class="dt">refs =</span> <span class="kw">c</span>(<span class="st">&quot;QUA.1&quot;</span>,
                    <span class="st">&quot;QUA.2&quot;</span>,
                    <span class="st">&quot;KAO&quot;</span>,
                    <span class="st">&quot;FEL&quot;</span>,
                    <span class="st">&quot;OLI&quot;</span>),
           <span class="dt">std =</span> <span class="st">&quot;QUA.1&quot;</span>,
           <span class="dt">align =</span> <span class="fl">0.2</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; -Using maximum tth range</span>
<span class="co">#&gt; -Using default solver of BFGS</span>
<span class="co">#&gt; -Using default objective function of Rwp</span>
<span class="co">#&gt; -Aligning sample to the internal standard</span>
<span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span>
<span class="co">#&gt; -Optimising...</span>
<span class="co">#&gt; -Computing phase concentrations</span>
<span class="co">#&gt; -Full pattern summation complete</span>

<span class="co">#plot the data to interpret the fit</span>
<span class="kw">plot</span>(fit)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Figure 3: The resulting full pattern fit on a sandstone soil when fps is applied using reference patterns from quartz (2 different standards), kaolinite, plagioclase, K-feldspar and organic matter." />
<p class="caption"><strong>Figure 3:</strong> The resulting full pattern fit on a sandstone soil when <code>fps</code> is applied using reference patterns from quartz (2 different standards), kaolinite, plagioclase, K-feldspar and organic matter.</p>
</div>
<p>When including all these phases, pretty much all peaks are accounted for. Once the user is satisfied that an appropriate fit has been achieved, the mineral concentrations can be extracted and interpreted by looking at two elements of the output from <code>fps()</code>:</p>
<ul>
<li><code>fit$phases</code></li>
<li><code>fit$phases_summary</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#returns individual contributions from each reference pattern</span>
fit<span class="op">$</span>phases
<span class="co">#&gt;   phase_id  phase_name  rir phase_percent</span>
<span class="co">#&gt; 1      FEL  K-feldspar 0.75       11.2386</span>
<span class="co">#&gt; 2      KAO   Kaolinite 0.91       11.0615</span>
<span class="co">#&gt; 3      OLI Plagioclase 1.06        7.2093</span>
<span class="co">#&gt; 4    QUA.1      Quartz 4.62       32.9080</span>
<span class="co">#&gt; 5    QUA.2      Quartz 4.34       37.5826</span>

<span class="co">#returns summed contributions from each mineral</span>
fit<span class="op">$</span>phases_summary
<span class="co">#&gt;    phase_name phase_percent</span>
<span class="co">#&gt; 1  K-feldspar       11.2386</span>
<span class="co">#&gt; 2   Kaolinite       11.0615</span>
<span class="co">#&gt; 3 Plagioclase        7.2093</span>
<span class="co">#&gt; 4      Quartz       70.4906</span></code></pre></div>
<p>All of the above and subsequent examples can be further tested using the two other XRPD measurements available in the <code>soils</code> list (<code>soils$limestone</code> and <code>soils$granite</code>), each representing soils with different mineralogies.</p>
</div>
<div id="fps-with-non-negative-least-squares" class="section level2">
<h2><code>fps()</code> with non-negative least squares</h2>
<p>As mentioned previously, an alternative to minimisation of an objective function (the default for <code>fps()</code>) is non-negative least squares (NNLS). This is implemented in <code>powdR</code> version 0.2.0, and provides very fast computation. Whilst NNLS can struggle with X-ray amorphous phases, its speed makes it particularly useful for fast quantitative estimates of a sample using a whole reference library at once. All phases with a coefficient equal to zero are excluded.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co">#Apply fps to the sandstone sample using NNLS. Note that when NNLS is selected as the solver argument, there is no need to define the refs because all phases in the library are used by default</span>
fit &lt;-<span class="st"> </span><span class="kw">fps</span>(<span class="dt">lib =</span> minerals,
           <span class="dt">smpl =</span> soils<span class="op">$</span>sandstone,
           <span class="dt">solver =</span> <span class="st">&quot;NNLS&quot;</span>,
           <span class="dt">std =</span> <span class="st">&quot;QUA.1&quot;</span>,
           <span class="dt">align =</span> <span class="fl">0.2</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; -Using maximum tth range</span>
<span class="co">#&gt; -Aligning sample to the internal standard</span>
<span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span>
<span class="co">#&gt; -Applying non-negative least squares</span>
<span class="co">#&gt; -Computing phase concentrations</span>
<span class="co">#&gt; -Full pattern summation complete</span>

<span class="co">#plot the data to interpret the fit</span>
<span class="kw">plot</span>(fit)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Figure 4: Application of fps()to the sandstone soil using NNLS instead of least squares optimisation." />
<p class="caption"><strong>Figure 4:</strong> Application of <code>fps()</code>to the sandstone soil using NNLS instead of least squares optimisation.</p>
</div>
</div>
<div id="automated-full-pattern-summation-afps" class="section level2">
<h2>Automated full pattern summation: <code>afps()</code></h2>
<p>Since NNLS is fast and can be used to exclude phases from large libraries (based on coefficients equal to zero), it has been used in combination with a method for estimating limits of detection <span class="citation">(S. Hillier 2003)</span> to create an algorithm for automated full pattern summation, <code>afps()</code>. The rationale behind this algorithm relates to the challenge of accurately quantifying high-throughput soil XRPD datasets, which show substantial variation in mineralogy. Large reference libraries are needed to handle such datasets, thus an algorithm was needed that both selected appropriate phases from a large library, and then excluded phases estimated to be below the detection limit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co">#Apply afps to the sandstone sample using afps. Note that amorphous phases need to be specified because they are treated differently to crystalline phases in this algorithm</span>
fit &lt;-<span class="st"> </span><span class="kw">afps</span>(<span class="dt">lib =</span> minerals,
           <span class="dt">smpl =</span> soils<span class="op">$</span>sandstone,
           <span class="dt">std =</span> <span class="st">&quot;QUA.1&quot;</span>,
           <span class="dt">amorphous =</span> <span class="st">&quot;ORG&quot;</span>,
           <span class="dt">align =</span> <span class="fl">0.2</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; -Using maximum tth range</span>
<span class="co">#&gt; -Using default shift of 0.05</span>
<span class="co">#&gt; -Using default solver of 'BFGS'</span>
<span class="co">#&gt; -Using default objective function of 'Rwp'</span>
<span class="co">#&gt; -Using default lod of 0.3</span>
<span class="co">#&gt; -Using default amorphous_lod of 0</span>
<span class="co">#&gt; -Aligning sample to the internal standard</span>
<span class="co">#&gt; -Interpolating library to same 2theta scale as aligned sample</span>
<span class="co">#&gt; -Applying non-negative least squares</span>
<span class="co">#&gt; -Optimising...</span>
<span class="co">#&gt; -Shifting patterns</span>
<span class="co">#&gt; -Reoptimising after shifting data/adding amorphous phases</span>
<span class="co">#&gt; -Removing negative coefficients and reoptimising...</span>
<span class="co">#&gt; -Calculating detection limits</span>
<span class="co">#&gt; -Removing phases below detection limit</span>
<span class="co">#&gt; -Reoptimising</span>
<span class="co">#&gt; -Computing phase concentrations</span>
<span class="co">#&gt; -Automated full pattern summation complete</span>

<span class="co">#plot the data to interpret the fit</span>
<span class="kw">plot</span>(fit)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAJACAMAAABlpiR1AAABNVBMVEUAAAAAADoAAGYAAP8AOmYAOpAAZpAAZrYAueMAujgAwZ8zMzM6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kJA6kNtNTU1NTW5NTY5NbqtNjshhnP9mAABmADpmAGZmOgBmOjpmOmZmOpBmZjpmZmZmZrZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQZgCQZpCQkGaQtpCQ27aQ2/+TqgCrbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC2Zjq2tma225C22/+2/7a2/9u2///Ijk3I///TkgDbcvvbkDrbkGbb/7bb/9vb///kq27k///r6+vy8vL4dm3/YcP/tmb/tpD/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T////lTka0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dC2Mbx3WFQdIsU4lS4taEJJux0zSF5IiyE9BpY5OSUxNNUpMs0ZaUFKJCAhKc//8TOrMPAIvd2dm9uHdnsDzHFpfE48PlzMfZB7A7HYUgAafjuwAEKQsERYIOBEWCDgRFgg4ERYIOBEWCDoug71bISk/mQqCIUgKHI9RAUBThJHA4Qg0ERRFOAocj1EBQFOEkcDhCDQRFEU4ChyPUQFAU4SRwOEINDjMhQQcjKIpwEjgcoQaCoggngcMRaiAoinASOByh5r4JehxCEVIECGoJe4vIISAogcDhCDUQ1EMRUgQIagl7i8ghICiBwOEINRDUQxFShIYFfV8YDqEWAkE9FCFFgKCWsLeIHAKCEgiWboegAggISiBYuh2CCiAgKIFg6XYIKoCAoASCpdshqAACghIIlm6HoAIICEogWLodggogICiBYOn2YkHHux2dXvah02+OKro0Pcw+FYJ6KEKKEIagj0+VGj/KCglBqwaCEgiWbi8R1AhphlIt281+Z+NI/zw93L7U33/0i6Pxz77YPNXfbp4q82D9b/zxv6aP/egLCOq9CClC04L+JZ90BP348ubnR8Y9MyKOtv/3m6PBnlL632jjaLzbi7/dvkwF3Y1+im5c2jqAoB6KkCKEMYJG26DaNp2bz08jX/WI+tO96EcztpqbzLda4VTQeBHdX2sVf/e6r9Ttq+6zt5YFBOVDhFtEPUGjVbzRbNDRa3E9lhpBDz/55aUZV1NBzb/5twsLNagj6FW3H0l69WnxAoIyIsItor6gWrOb/d5MOuPicI9/BJ38+jd9dfv1uZp8eV64gKCMiHCLqC9o6t6jIyPc+PGP35j9pHQbNBooo61Os6E63EwFrbsNevfmBz1QTl6+VbdfnRQu9IMe6pRJHliOfRfQopRtg/aUGnaiXfJ0Lz4aIvc7fxePoCreizcP+uTzmaDTw1p78VcHZk3+4VnkYuEieSD7n6wcAiMogVBLUIfV8Sq/ekoE1aPknXsEhaBciHCL4BJUD5B6NK3lZ5mgV12TA2yDshchRQhdUErch5nuXh/E++0FiyTsLSKHgKAEgsWOQATFcVD2IqQI90/QimFvETkEBCUQOByhBoJ6KEKKgBHUEvYWkUNAUALB0u0QVAABQQkES7dDUH7EMQQlECzdDkH5ERCUQrB0OwTlR0BQCsHS7RCUHwFBKQRLt0NQfgQEpRAs3Q5B+REQlEKwdHuxoPHH7fbiRfLhzxUCQZsvQowQhqCxkamYEBSCihdh6XYIyo+AoBSCpdvf/1c+EHQ1BASlECzdXrINuqPSs48hKAQVL8LS7VjF8yMgKIVg6XYIyo+AoBSCpdshKD8CglIIlm4vFzTaBu304uUO2S0I2nwRYoQgBOUQaiEsgq5PjnHhBr6sj6Dsf7JiCIygFIKl2yEoPwKCUgiWboeg/AgISiFYuh2C8iMgKIXA4Qg1ELT5IsQIGEEtYW8RMQQEpRAs3Q5B+REQlEKwdDsE5UdAUArB0u0QlB8BQSkES7dDUH4EBKUQLN0OQfkREJRCsHQ7BOVHQFAKwdLtEJQfAUEpBEu3FwuannYczX6U/TTo8hxIVQJBmy9CjBCGoDMnIWh9BASlECzdXiro+PF/7puhNJ3XuGgm4yqBoM0XIUZoWtDjfBZP+UhG0MGeGu6oolnkqgSCNl+EGCGMETQ57TgV1Mx2ePN54TycVQJBmy9CjBCGoEsj6M3+/BpNg15ttyBo80WIEcIU9PPoZ4yglQJBKQRLt1cTNJnXWGIb9EO3+/S8XRN5QVAKgSjo9HDzx8NoL95M0Fkwk/GKgpq5OKNZD/vWBQRlRIRbRC1BaytIFtTENovsuk4mC0EpBIscIQiqR0nHdNwPdZhrEgzOi2eMf0Enz5+cqA/PIhcLF8nj2P9kxRDH1wEUIUa4hyOobeicj6Am7C0ihoCgFIJFjhAEVWf9dm2DQlACgdm5WikRNFmN370+iPfbCxZJ2FtEDAFBKQSLIN5H0KtuV2+Dtus4KAQlECx+eBe0cthbRAwBQSkES7dDUH4EBKUQLN0OQfkREJRCsHQ7BOVHQFAKwdLtEJQfAUEpBEu3Q1B+BASlECzdDkH5ERCUQrB0e7Gg0cftpoc7SpmTPXSGZrIPslsQtPkixAjBCBp/dH70qz39dbh9qW7296huQdDmixAjhCJo7Of0m+9+eaniMz7o03lB0OaLECM0Lejf52ME/TE+9Wj88eWgF53tQbtkQ5yMoDf7veQs+3phbxExBASlECzdbhlBH/00nlhuuKdGO+Z/k0GvrlRJMoIOdtRw83RYe9469hYRQ0BQCsHS7RZBd/eiTc7pYXRdkVhQnhFUD6Bm72tUewhlbxExBASlECzdbt9JGj86Mmt4M3ByboNGa/i9Vgt6DUEJBEu3lxxm0rvuw55+yChaJ3PtxU8P90YbR2ZFXzPsLSKGgKAUgqXbSwSdHn70T2aYM4dCR3zHQce7evN2EO121Qp7i4ghICiFYOn2YkFJGtpzzw4zQVAKwdLtjQuqt0HNAtugwkWIESDo2uf62ncFLUrDgpr39ONgJ0m2CDHCPRlB64e9RcQQEJRC4BCNGuwkNV+EGKHtI6iKZxCp/2Y8e4uIISAohWDp9sYFjT5lSgl7i4ghICiFYOl2bIPyIyAohWDpdg8jaI8GYW8RMQQEpRAs3d78Nij1CCh7i4ghICiFYOl2D6v4DnaSGihCjNB2QclhbxExBASlECzdDkH5ERCUQrB0e7Gg411zLGhQazVcsveDVXzzRYgRwhD00T9cqptf1PoIfUVB4ySn29cJe4uIISAohWDpdougj//5SI1/9dh8jj4a68zbP9q/UTTyRSeEPD4d/+yLitMgF6ziR7U/sczeImIICEoh2AR9kI8R9I899d/fzqY5NgNeMiPicGcm6G5PVZsGuUhQrOJlixAjBDKC/ukfp7/702yaY/NIM9txvGJOBTUDbKVpkAsErX/OB3uLiCEgKIVQU9Af/+1//mU+zbEWKl6575ofFgWtNA1ywU7SBrZBZYsQIwQi6Ol//H5vYZrj/V561rHeeFwUtNI0yDjM1HwRYoRQBB3F42I8zXFynrzZs9H/zHp9uHkaD5tVpkGGoM0XIUYIRdD5OtysjYedaC89XtGbnz75PBa00jTIWUGj0z7qn2PP3iJiCAhKIdQStLY95ckIOowPS6WGTp53u/12zZMEQSmEUARdOqvTzMU5eXHSqvniISiFEKigH4yALZurE4JSCKEIuryKV1VmO16v+eJxXjxjmhc0t5Nk5oxt1XzxGEEpBGbnaqX0MNPtqwO9q9Sm+eIhKIVg0cPDCJrN5Lneh1fYBuUuQozQckGjfaTp4eyd+NjP4oni13W+eAhKIYQh6Hg33vicfRb6qmvSx3FQ7iLECO0WdHZhZVxhWbgIMUKrBZ1ftQGfBxUuQowAQS1hbxExBASlECzd3qyg08P0+OcQH1iWLUKM0GpB47eR1KKplcPeImIICEohWLrdJmgyvXHyKWX6FElRFg4zDaKP0t/sY5YP4SLECGEImk5vzC5ofHnQ+id8QFAeRLhFWLq9WNDZ1HL8gpLD3iJiCAhKIVi6/f1P8nn/fja9MQQlICAohWDp9uIRdDa9MQQlICAohWDp9jJBMYLSEBCUQrB0O7ZB+REQlEKwdLttLz6Z3hiCEhAQlEKwdLtF0HR643jOmB0ICkGli7B0u01Q1kDQ5osQI0BQS9hbRAwBQSkES7dDUH4EBKUQLN0OQfkREJRCsHT7+gi6PsF58esWjKDNFyFGwAhqCXuLiCEgKIVg6XYIyo+AoBSCpdshKD8CglIIlm6HoPwICEohWLodgvIjICiFYOl2CMqPgKAUgqXbISg/4vr6gf8ixAgQ1BL2FhFDYASlECzdbhN0uPhxu+hkdvMBvNoXVIoDQZsvQowQhqDZ047NT+ZaNYTLLUSBoM0XIUYIQtClUz7013geufHHta+3YHLvBMU2aH2Cpdvff5ZP7rTjYTzXHDn3TtAAihAjBDGCzk87jrZBta7EsTMOBG2+CDFCQIImI+jIXKgmmq1zl3TNGgjqowgxQhCCZrdBh5vpXMbJhPF1c+8ExTZofYKl22178YunHU8P9YAajaMjjKAVghGUQrB0u0XQ2WnH8V68mfrAbI7WvixyHAjafBFihEAEZQ0Ebb4IMQIEtYS9RcQQ19fH/osQI9w/QaPJ5No1TxIErU+w2OFf0A/dp+fFE8Wv73zxELQ+waKHd0HPnvy7HkFbNlcnBK1PYHauVtyr+JbNF3/su4T2xPsIGgu6JvPFF46MuWAEpRAsdgQi6JrMFw9B5Yqw2BGIoGuyDQpB5Yqw2BGIoGsyXzwElSvCYkcggq7JcdDjwk+BLAeCUggWOwIQtGLYW4SAwAgqV4Sl2yFoHQQElSvC0u0QtA4CgsoVYel2m6CZ2Y6jrwsfVq57glJ7BK1kKASlECzdbhF0EJ123FsUdPSr9JzjUd3Phd43QS8KP28XrhtBFGHp9mJBYy9H6cmc5uv0m+9+GZ83N9j4FiNoWSAohWDp9vcX+aQnzemV+lzQ8ceXg17yJKziSwNBKQRLtxePoMP4rM5vFgQd7qlReuUbCFoaCEohWLq9WND8CDo97MxPSYKgpYGgFIKl2+3boP93pNfq8a67/ia6cMOgFz8JgpYGglIIlm637MUPty9v9s1xpsGOiq4ZNtTfz9bxELQ0EJRCsHS7RVBzHHTzj509bahete+p6e+Mkjc//3Z+2KlGIChnEZ4JgQjKGgjKWYRnAgS1hL1FCIjit4iWA0EpBEu3Q9A6CAgqV4Sl2yFoHQQElSvC0u0QtA4CgsoVYel2CFoHAUHliuBwhJrWzBdfbSZ4Lah0IfcnGEHrICzXrVsKRlAKwdLtELQOopKgxxCUQrB0OwStg4CgckVYuh2C1kG0QNBqp1UJF1F4Y3EgaB0EBOUpovDG4kDQOggIylNE4Y3FgaB1EBCUp4jCG4tjE7TktGMz3Uevllv3S9DrCwhKIFi63SJoyWnHRtTxo1rzJUFQziJWI7RD0LLTjqOP1Q96ddyCoHWLKNDouCaiOOsn6HU+ztOO606JCEFrFlH0wWgeQat95Lo0IYygjtOOzUlKddIWQY8rCvouYEGrfd6ljBCCoOWnHZtJPGsFgtYsImhBK10jtTQ826DW047Hu72abkHQmkUELSgNsPgshr34ktOO6/sJQesWUSjocR5R3xVfgh4vPo3pOKjltGNzhLTmgdD7J2hRJ9YRtOB1rvOCEly5Lv7jqRGKoA/4BWVNWwS1vEWUzTGDoAV/CA8iQbNcL4JShuDj6L9ZIGjul1/lyXOEFtTdO0KCRqO3yippEbSsRtffmPP3e1DtQ9tLVF39wtMgaO6XX+XJM8RxZUELH1dL0NzzCwUtLmclQV2/4LHl+tFleQBBHVlZ0AfGjUjQqAftXaQf9C4SNH80ZjVBI7NU9vZiV47LDHUL6tCPImik58LTWiOo2DxJFZpY/9UvJend3O3RfQ/M/dF3egDVgr5Ln2Mvwp4iCRJBr3O3FTy75O/HtRK4vnYoen2hrIrbnmlG/4uF36ktglaYL/4470FBHpgnP4j+KxTss4q5/uziuvQBpgMjQaNdkeNCme1lxncfp0N1VHN887t09L6+XgAU21bmYGxKSQ1mrCuv0fZGblpp8XPeXVxc0ARtJERBK8zVGX94gK5ckr/Ye2TeqNfRxmXpGtIUc3Hx2We6N0xqVjH/Q7jI/SFoWPT/IlS/VtFL5G5daJfri79cFLXX/P6L4gadPcCMoLb7Lc80bWIUTe980BZBK8wXH19Uv+ADLxK5uPiJ67VMNT8xWa0s/ULFN2WhBQ8zKb41qW/212N5wGeOwg3ATrc+xyS9ly6SVIiChjdfvGdCq4tgs42QlUdQE/YWaRqBIkoJbLYRIrcNukqLNI1AEaUENtsIIe/FhzZfvGdCq4vgko2S4I6DekGgiFICk2ukrP87Se12I4giOByhBoKiCCeBwxFqICiKcBI4HKEGgqIIJ4HDEWogKIpwEjgcoaYNlwAvfqu14aAImUBQpqAImUBQpqAImUBQpqAImbRBUKTFgaBI0IGgSNCBoEjQgaBI0FlvQSfPu93+0mf/PMSc4+q5iLvX3ScnvouQyFoLak46mbw4yZ4D7SFX+q/EcxFnfXOemPeW4M9aC/rB9MVZP3v+SfOZ/Po3feW3CPPqavlMnFZkrQU10aNo9gy+xnP35gc9cPktYvLyD2YV77klJLLugpqTo7LnQDeeqwOzZvVbxOR59CfiuSUksuaC3r46WD4HuunoV78LYAR9G8C6RCLrLagZOHxveV11TQ48b4P+NjIT26BhJfZz6RxoDzEjqOcizvrxUO65Jfiz1oLGg1ff+9G/AI6D6ld/eu67CImstaBI+wNBkaADQZGgA0GRoANBkaADQZGgA0GRoANBkaADQV252e90Nk+V+uuf1fjRUfY+fRsiGwjqyM3+jlKD7Usj57KgOWER9kBQR0YbR5GJENRPIGiVjB99u9vp7I0f/b7T6fSUmh6a1f7Y3KbMV71AZAJBqyRdxe9uX6rh5un0UK/2h/FtN/s9ZW7zXWJbA0ErZLgRr97Hu71ovT4yPmozzW1/u1RY1wsGgrozNGv12Tao/jLsRNmLvRzpbzcgqFAgqDODyL6MoNuX0T3xKn4jv/eEsAWCupJsXy4KOkoGTPPzyMg6wggqFQjqSDo4mp2hVNDpobZSS2luM26OdyGoVCCoI8n2Zk8NOjupoNFhJuOkvk3/62x8Z3blEYlAUCToQFAk6EBQJOhAUCToQFAk6EBQJOhAUCToQFAk6EBQJOhAUCToQFAk6EBQJOhAUCToQFAk6LgENRcxfnqeXrk3u0AQ8bgEPUuuAh/NYJZdIIh8HILevYnmNElmj8gumigPue9xCKpX5maWguw0PPPZeB7qNFImcl/jEHTy4sSMoskMZtlF8pB3q2S1Z7MxUIYTIW6iJVX24s/6thHUhL8tmmegDCdCUsKyVBO0bBuUvy2aZ6AMJ0JSwrI4BDVr87vvz5MZzLKLJPxt0TwDZTgR0iLaUuE46JOT5QOgmeOg/G3RPANlOBHCHlqz+jtJ/G3RPANlOBEMrpECQZkQbS+DwTVSICgTou1lMLhGCgRlQrS9DAbXSLlvgm6FUYYYAoLmwt8WkgwISkQwuEYKBPVShhgCgubC3xaSDAhKRDC4RgoE9VKGGAKC5sLfFpIMCEpEMLhGCgT1UoYYAoLmwt8WkgwISkQwuEYKBPVShhgCgubC3xaSDAhKRDC4RgoE9VKGGAKC5sLfFpIMCEpEMLhGyj0TdAuCEhEMrpECQX2UIYeAoLnwt4UgA4JSEQyukQJBfZQhh4CgufC3hSADglIRDK6RAkF9lCGHgKDrna0t3xUg9YIR1EcZcgiMoLnwt4UgA4JSEQyukQJBfZQhh4CgufC3hSADglIRDK6RAkF9lCGHgKC58LeFIAOCUhEMrpECQX2UIYeAoLnwt4UgA4JSEQyukQJBfZQhh4CgufC3hSADglIRDK6RAkF9lCGHgKC58LeFIAOCUhEMrpECQX2UIYeAoLnwt4UgA4JSEQyukQJBfZQhh4CgufC3hSADglIRDK6RAkF9lCGHgKC58LeFIAOCUhEMrpECQX2UIYeAoLnwt4UgA4JSEQyukQJBfZQhh4CgufC3hSADglIRDK6RAkF9lCGHgKC58LeFIAOCUhEMrpECQX2UIYe4d4JOnne7faWuut3u03N1+6r77K1KF3H420KQAUGpCGEPrXEIevvViZq8OFFnffPT3eu+uvo0XSThbwtBBgSlImQ1tMch6Afj4Vn/7s2J+en263M1+fI8WSQP4W8LQQYEpSJkNbSnwjaoHkX1Ot2s6Scv35qfkoW+66GOeImcwcXD1i1uQe9eH0RreT2KfngWmZkskvv5/1gFGRhBqQhZDe1xCnr76iD57qyfG0FN+NtCkAFBqQg5Bcvj3ovvp9+e9bENylSGHOK+CZr4aVbqd9+fm7V9tBd/gL14CUbIZchqaI9DUHP80+we6eWTE4XjoExlyCHum6AVwt8WggwISkUwuEYKBPVRhhwCgubC3xaCDAhKRTC4RgoE9VGGHAKC5sLfFoIMCEpFMLhGCgT1UYYcAoLmwt8WJEaxecuBoFQEg2ukQFDeMnwjIGgu/G1BYkBQNgYEdbQFiQFB2RgQ1NEWJAYEZWNAUEdbkBgQlI0BQR1tQWJAUDYGBHW0BYkBQdkYENTRFiQGBGVjQFBHW5AYEJSNAUEdbUFiQFA2BgR1tAWJAUHZGBDU0RYkBgRlY0BQR1uQGBCUjQFBHW1BYkBQNgYEdbQFiQFB2RgtEzSQVLvoEq7NtG7BCMpbhm8ERtBc+NuCxICgbAwI6mgLEgOCsjEgqKMtKAyLecuBoFQEg2ukQFDWMrwjIGgu/G1BYUBQPgYEdbQFhQFB+RgQ1NEWFAYE5WNAUEdbUBgQlI8RrqA3+72b/c7maS0Cf1tQGBCUjxGuoIMdNdw8He7UIvC3BYUBQfkYwQqqB9Dp4Y4a1RtC+duCwoCgfIyQBb3Z34OgK5ThHdFqQaeHe6ONI7OirxP+tqAwICgfI1hB1Xi3s6MG25e1CPxtQWFAUD5GuIKSwt8WFAYE5WMEK6jeBjULbIPSy/COgKC58LcFhQFB+RiBCjrspMFOErkM74gWCzobQWuGvy0oDAjKxwhWUFr424LCaE5Q2wtxmFHtlyhnCCEYXCNl+TCTCbZBSxFlZayWir9EKaLNgpr3OeuHvy0oDL+CbtVk2NAQNBdsg9YtA4I2muwI2iMQ+NuCwmhQ0AJELOiqem2tLugWSVD9uouvHKyglY+A3r7qPnub/kBrybK2oDCcfRvfv5VZkMooeKWtIkEtBZXU6RbUeT/J8a11EfRmv1NpJ+nudV9dfZr+VL9BlttioXFqN+9WMmZEjbyVvWeBmd6Zfl3qR+cvMX/88lO3UpyyvLwNVHRfuV5VBCYKurUWglbN7dfnavLlefJTpd899qdG3s1kejf/Ome+m0HfLbzA7GXSV97aitdfib7pDVtxVyaPmC3jV9xKXm0r8zukfwCzvpy/yLv5l7SEXJ8vkpZvmQ/rdgMXXq3krzjzR7okqx2eq3btBZ28fKtuvzrR3z3UKX7MlsoKN/8xvYLXVubR0dfoUUtPdCV+XvTcmJG+nkpR8f3pXSp9zvyVkle2v3AWnH2gyn1T8Pyqv0r5Q92YgoZ3Pzv99dOnEowQDGUV/+FZKqhJyZ+8O+51axWGadalh24VfJ8ZKjKPrrcNmtl4mN20zFioqVJbxFsJi+1WuDdW2LCLT9oqH4at90VPjB4R+Ah68/Mjx3PmI6iJ/ZeuEK6dpMo78cXdt2oZ0Tboiox3saCrMqiEhecFLqgauT6xXGMb1BUPgkqUwXQclOOtTql3Sy0uvC/MKkYupUhQ9178Aete/IoJQFAmxhq+F+9DUPc5H+EdB60uqGgZ/hGtFjTZSdpwbYNmw98WBAYEZWQEKygt/G1BYKz2TmfQZjTPgKCOtqAwICgfI2BBo9M+9uoR+NuCwoCgfIxwBR2a/XdzcZE64W8LCgOC8jGCFXStz+qs9FAISkZYer9U0PgMjZxO48fRLblPdya3Q1DBMrwjwhI0Mm5oOWxZX1Cs4lcuwzsiQEHN1+Sys6NoPE1u+OiLnvku+qeH2l703Wh5xMVOEmsZ3hGNC1rw8aiCEXSwp4Y76ubzU7MwN+sbRp1UUPPxD70w38WPsApKCX9bUBgQlI/BvA2q/TQGaveSzyElIupVfDqC6uhbElWzgaCsZXhHhCWoWWebNyaj9yj1N9rYjXSwVGowF3Rg1uzJyj77TuaCoNE+0vSw5tUXISgfI+QyqIJGOzZmwEwy2r7MjaDGvNTa5U/TzQUd78Ybn4P1nESh2mMhKBVBFjS62oLZ5Ny+NOrFgibboGaNPkyGzkdHepE8olDQ2YWV1/MKy9UeC0GpCLKg0cin1/FmzT2Y7cVPD81evNkr/8TsF3XSffqBdS9+ftWGFh8HhaBkBEVQjkBQ1jK8I9or6PQwPf5pO/JvCX9bUBgQlI8RpqDx20hq0dRq4W8LCgOC8jECFVQNogNQN/vrOctHtcdCUCrC0vtNChof+K95wgcEZWSEXAajc7Vyv95JgqBkBINrpEBQ1jK8IyBooKl4RaHALjyEOIMRlLUM7wiMoLnwtwWFAUH5GBDU0RYUBgTlY0BQR1tQGBCUjwFBHW0hyICgVASDa6RAUB9lyCEgaC78bSHIgKBUBINrpEBQH2XIISBoLvxtIciAoFQEg2ukQFAfZcghIGgu/G0hyICgVASDa6RAUB9lyCEgaC78bSHIgKBUBINrpEBQH2XIISBoLvxtIciAoFQEg2ukQFAfZcghIGgu/G0hyICgVASDa6RAUB9lyCEgaC78bSHIgKBUBINrpEBQH2XIISBoLvxtIciAoFQEg2ukQFAfZcghIGgu/G0hyICgVASDa6RAUB9lyCEgaC78bSHIgKBUBINrpLgEnTzvdvtKXXW73afn6vZV99lblS7i8LeFIAOCUhHCHlrjEPT2qxM1eXGizvrmp7vXfXX1abpIwt8WggwISkXIamiPQ9APxsOz/t2bE/PT7dfnavLlebJIHsLfFoIMCEpFyGpoT4VtUD2K6nW6WdNPXr41PyULfddDHfESOYOLh61b3ILevT6I1vJ6FP3wLDIzWST38/+xCjIwglIRshraUyLoWbf7qdkhOkh/7udGUBP+thBkQFAqQlpEW9x78f3027M+tkGZypBD3DdBEz/NSv3u+3Ozto/24g+wFy/BCLkMWQ3tcQhqjn+a3SO9fHKicByUqQw5xH0TtEL420KQAUGpCAbXSIGgPsqQQ4tkjJEAAAUFSURBVEDQXPjbQpABQakIBtdIgaA+ypBDQNBc+NtCkAFBqQgG10iBoD7KkENA0Fz420KQAUGpCAbXSIGgPsqQQ0DQXPjbQpABQakIBtdIgaA+ypBDQNBc+NtCkAFBqQgG10iBoD7KkENA0Fz420KQAUGpCAbXSIGgPsqQQ0DQXPjbQpABQakIBtdIgaA+ypBDQNBc+NtCkAFBqQgG10iBoD7KkENA0Fz420KQAUGpCAbXSIGgPsqQQ0DQXPjbQpABQakIBtdIgaA+ypBDQND1Dq7NtG7BCOqjDDkERtBc+NtCkAFBqQgG10iBoD7KkENA0Fz420KQAUGpCAbXSIGgPsqQQ0DQXPjbQpABQakIBtdIgaA+ypBDQNBc+NtCkAFBqQgG10iBoD7KkENA0Fz420KQAUGpCAbXSIGgPsqQQ0DQXPjbQpABQakIBtdIgaA+ypBDQNBc+NtCkAFBqQgG10iBoD7KkENA0Fz420KQAUGpCAbXSIGgPsqQQ0DQXPjbQpABQakIBtdIgaA+ypBDQNBc+NtCkAFBqQgG10iBoD7KkENA0Fz420KQAUGpCAbXSIGgPsqQQ0DQXPjbQpABQakIBtdIcQlqJox/er40Ufz6zhcvh2h7GcIeWuMS9Kxvvt697qurT5cWSfjbonkGynAiRC0siUPQuzcnZnH79bmafHmeXSQP4W+L5hkow4kQ9tAah6B6Zd7t9tXk5Vt1+9VJdqHvfqjTSJnIfY1D0MmLEzOKfngWKZldJA/h/2NtnoEynAhxEy0pEfSs2403NM/6thHUhL8tmmegDCdCXsXiVDnMdNbHNmgjjJDLkJSwLA5Bzdr87vvzu9cH8e774iIJf1s0z0AZToS0iLZUOA765GT5ACiOg8owQi5D2ENr7tk7SXKItpfB4BopLbgEeCAHulCGSCAoV1CGSCAoV1CGSCAoV1CGSFogKNLmQFAk6EBQJOhAUCToQFAk6Ky1oJPn5sOq2XdevcScY+C9jLvXi+9KtyXrLKj5yN/kxUn2DBQvudJ/J97LOOubz/Z4L4M56yzoB9MPs88Ceixk8uvf9JXvMszrK+W9DO6ss6Amuc9Pe8jdmx9ez06L8VbF5OUfzCredxncWXNBzUdTs2egeMjVgVmv+i5j8jz6I/FdBnfWW9DbVwfK+5ihX/8uiBG04Hyc9c9aC2oGDf9bXebaFt3uge8ybn8bmem7DO6ss6Cxn0tnoHiJGUG9l3HWjwdz763BmnUWNB66+gEc+QviOKh+/afn/stgzjoLityDQFAk6EBQJOhAUCToQFAk6EBQJOhAUCToQFAk6EBQV272O53NU6X++mc1fnSUvU/fhsgGgjpys7+j1GD70si5LGhOWIQ9ENSR0cZRZCIE9RMIWiXjR9/udjp740e/73Q6PaWmh2a1Pza3KfNVLxCZQNAqSVfxu9uXarh5Oj3Uq/1hfNvNfk+Z23yX2NZA0AoZbsSr9/FuL1qvj4yP2kxz298uFdb1goGg7gzNWn22Daq/DDtR9mIvR/rbDQgqFAjqzCCyLyPo9mV0T7yK38jvPSFsgaCuJNuXi4KOkgHT/Dwyso4wgkoFgjqSDo5mZygVdHqordRSmtuMm+NdCCoVCOpIsr3ZU4POTipodJjJOKlv0/86G9+ZXXlEIhAUCToQFAk6EBQJOhAUCToQFAk6EBQJOhAUCToQFAk6EBQJOhAUCTr/D+B8V4TSkRQfAAAAAElFTkSuQmCC" alt="Figure 5: Application of afps() to the sandstone soil." />
<p class="caption"><strong>Figure 5:</strong> Application of <code>afps()</code> to the sandstone soil.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Chipera2002">
<p>Chipera, Steve J., and David L. Bish. 2002. FULLPAT: A full-pattern quantitative analysis program for X-ray powder diffraction using measured and calculated patterns. <em>Journal of Applied Crystallography</em> 35 (6): 74449. doi:<a href="https://doi.org/10.1107/S0021889802017405">10.1107/S0021889802017405</a>.</p>
</div>
<div id="ref-Chipera2013">
<p>. 2013. Fitting Full X-Ray Diffraction Patterns for Quantitative Analysis: A Method for Readily Quantifying Crystalline and Disordered Phases. <em>Advances in Materials Physics and Chemistry</em> 03 (01): 4753. doi:<a href="https://doi.org/10.4236/ampc.2013.31A007">10.4236/ampc.2013.31A007</a>.</p>
</div>
<div id="ref-Eberl2003">
<p>Eberl, D. D. 2003. Users guide to ROCKJOCK - A program for determining quantitative mineralogy from powder X-ray diffraction data. Boulder, CA: USGS.</p>
</div>
<div id="ref-Hillier2003">
<p>Hillier, S. 2003. Quantitative Analysis of Clay and Other Minerals in Sandstones by X-Ray Powder Diffraction (XRPD). <em>Clay Mineral Cements in Sandstones</em> 34. International Association of Sedimentologists, Special Publication: 21351.</p>
</div>
<div id="ref-Omotoso2006">
<p>Omotoso, Oladipo, Douglas K. McCarty, Stephen Hillier, and Reinhard Kleeberg. 2006. Some successful approaches to quantitative mineral analysis as revealed by the 3rd reynolds cup contest. <em>Clays and Clay Minerals</em> 54 (6): 74860. doi:<a href="https://doi.org/10.1346/CCMN.2006.0540609">10.1346/CCMN.2006.0540609</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
